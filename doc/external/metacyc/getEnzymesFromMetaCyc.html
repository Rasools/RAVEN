<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of getEnzymesFromMetaCyc</title>
  <meta name="keywords" content="getEnzymesFromMetaCyc">
  <meta name="description" content="getEnzymesFromMetaCyc">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">external</a> &gt; <a href="index.html">metacyc</a> &gt; getEnzymesFromMetaCyc.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for external/metacyc&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>getEnzymesFromMetaCyc
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>getEnzymesFromMetaCyc</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function metaCycEnzymes=getEnzymesFromMetaCyc(metacycPath) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> getEnzymesFromMetaCyc
    Retrieves all enzymes and reaction-enzyme association information in MetaCyc

   Input:
    metacycPath  if metaCycEnzymes.mat is not in the RAVEN\external\metacyc
                directory, this function will attempt to build it by reading
                info from a local dump of MetaCyc database, and metacycPath
                is the path to the MetaCyc data files

   Output:
    model        a model structure generated from the database. The following
                fields are filled
                id:             'MetaCyc'
                description:    'Automatically generated from MetaCyc database'
                rxns:           Reaction id
                rxnNames:       Reaction name
                enzymes:        Enzyme id
                enzrxns:        Enzymatic-reaction id
                cplxs:          Enzyme complexes
                cplxComp:       Subunit components of enzyme complexes
                rxnEnzymeMat    A binary matrix that indicates association of a
                                specific enzyme to the reactions it catalyze
                version:        MetaCyc database version

    If the file metaCycEnzymes.mat is in the RAVEN\external\metacyc directory
    it will be loaded. Otherwise, it will be generated by parsing the MetaCyc
    database files. In general, this metaCycEnzymes.mat file should be removed
    and rebuilt when a newer version of MetaCyc is released.

    Usage: model=getEnzymesFromMetaCyc(metacycPath)

    Hao Wang, 2018-10-31</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="getModelFromMetaCyc.html" class="code" title="function metaCycModel=getModelFromMetaCyc(metacycPath,keepTransportRxns,keepUnbalanced,keepUndetermined)">getModelFromMetaCyc</a>	getModelFromMetaCyc</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function metaCycEnzymes=getEnzymesFromMetaCyc(metacycPath)</a>
0002 <span class="comment">% getEnzymesFromMetaCyc</span>
0003 <span class="comment">%    Retrieves all enzymes and reaction-enzyme association information in MetaCyc</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   Input:</span>
0006 <span class="comment">%    metacycPath  if metaCycEnzymes.mat is not in the RAVEN\external\metacyc</span>
0007 <span class="comment">%                directory, this function will attempt to build it by reading</span>
0008 <span class="comment">%                info from a local dump of MetaCyc database, and metacycPath</span>
0009 <span class="comment">%                is the path to the MetaCyc data files</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%   Output:</span>
0012 <span class="comment">%    model        a model structure generated from the database. The following</span>
0013 <span class="comment">%                fields are filled</span>
0014 <span class="comment">%                id:             'MetaCyc'</span>
0015 <span class="comment">%                description:    'Automatically generated from MetaCyc database'</span>
0016 <span class="comment">%                rxns:           Reaction id</span>
0017 <span class="comment">%                rxnNames:       Reaction name</span>
0018 <span class="comment">%                enzymes:        Enzyme id</span>
0019 <span class="comment">%                enzrxns:        Enzymatic-reaction id</span>
0020 <span class="comment">%                cplxs:          Enzyme complexes</span>
0021 <span class="comment">%                cplxComp:       Subunit components of enzyme complexes</span>
0022 <span class="comment">%                rxnEnzymeMat    A binary matrix that indicates association of a</span>
0023 <span class="comment">%                                specific enzyme to the reactions it catalyze</span>
0024 <span class="comment">%                version:        MetaCyc database version</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%    If the file metaCycEnzymes.mat is in the RAVEN\external\metacyc directory</span>
0027 <span class="comment">%    it will be loaded. Otherwise, it will be generated by parsing the MetaCyc</span>
0028 <span class="comment">%    database files. In general, this metaCycEnzymes.mat file should be removed</span>
0029 <span class="comment">%    and rebuilt when a newer version of MetaCyc is released.</span>
0030 <span class="comment">%</span>
0031 <span class="comment">%    Usage: model=getEnzymesFromMetaCyc(metacycPath)</span>
0032 <span class="comment">%</span>
0033 <span class="comment">%    Hao Wang, 2018-10-31</span>
0034 <span class="comment">%</span>
0035 
0036 <span class="comment">%NOTE: This is how one entry looks in the files</span>
0037 
0038 <span class="comment">%proteins.dat</span>
0039 <span class="comment">% UNIQUE-ID - MONOMER-8570</span>
0040 <span class="comment">% TYPES - Polypeptides</span>
0041 <span class="comment">% COMMON-NAME - D-carnitine dehydrogenase subunit</span>
0042 <span class="comment">% COMPONENT-OF - CPLX-5143</span>
0043 <span class="comment">% MOLECULAR-WEIGHT-EXP - 23</span>
0044 <span class="comment">% MOLECULAR-WEIGHT-KD - 23</span>
0045 <span class="comment">% SPECIES - ORG-6256</span>
0046 <span class="comment">% //</span>
0047 
0048 <span class="comment">%enzrxns.dat</span>
0049 <span class="comment">% UNIQUE-ID - ENZRXN-14974</span>
0050 <span class="comment">% TYPES - Enzymatic-Reactions</span>
0051 <span class="comment">% COMMON-NAME - (1S,4R)-iso-dihydrocarvone monooxygenase</span>
0052 <span class="comment">% BASIS-FOR-ASSIGNMENT - :MANUAL</span>
0053 <span class="comment">% CITATIONS - 10769172:EV-EXP-IDA-PURIFIED-PROTEIN:3419689584:caspi</span>
0054 <span class="comment">% COFACTORS - FAD</span>
0055 <span class="comment">% ENZYME - MONOMER-13964</span>
0056 <span class="comment">% PHYSIOLOGICALLY-RELEVANT? - T</span>
0057 <span class="comment">% REACTION - RXN-9435</span>
0058 <span class="comment">% REGULATED-BY - REG-12241</span>
0059 <span class="comment">% REGULATED-BY - REG-12240</span>
0060 <span class="comment">% TEMPERATURE-OPT - 35</span>
0061 
0062 <span class="comment">% A line that contains only '//' separates each object.</span>
0063 
0064 <span class="comment">%Check if the enzymatic proteins have been parsed before and saved. If so,</span>
0065 <span class="comment">%load the model.</span>
0066 [ST, I]=dbstack(<span class="string">'-completenames'</span>);
0067 ravenPath=fileparts(fileparts(fileparts(ST(I).file)));
0068 enzymesFile=fullfile(ravenPath,<span class="string">'external'</span>,<span class="string">'metacyc'</span>,<span class="string">'metaCycEnzymes.mat'</span>);
0069 metaCycProteinFile=<span class="string">'proteins.dat'</span>;
0070 metaCycEnzrxnsFile=<span class="string">'enzrxns.dat'</span>;
0071 
0072 <span class="keyword">if</span> exist(enzymesFile, <span class="string">'file'</span>)
0073     fprintf([<span class="string">'NOTE: Importing MetaCyc enzymes and reaction-enzyme association from '</span> strrep(enzymesFile,<span class="string">'\'</span>,<span class="string">'/'</span>) <span class="string">'.\n'</span>]);
0074     load(enzymesFile);
0075 <span class="keyword">else</span>
0076     fprintf([<span class="string">'Cannot locate '</span> strrep(enzymesFile,<span class="string">'\'</span>,<span class="string">'/'</span>) <span class="string">'\nNow try to generate it from local MetaCyc data files...\n'</span>]);
0077     <span class="keyword">if</span> ~exist(fullfile(metacycPath,metaCycProteinFile),<span class="string">'file'</span>) || ~exist(fullfile(metacycPath,metaCycEnzrxnsFile),<span class="string">'file'</span>)
0078         EM=fprintf([<span class="string">'The files of enzymes or proteins cannot be located, and should be downloaded from MetaCyc.\n'</span>]);
0079         dispEM(EM);
0080     <span class="keyword">else</span>
0081         metaCycEnzymes.id=<span class="string">'MetaCyc'</span>;
0082         metaCycEnzymes.description=<span class="string">'Automatically generated from MetaCyc database'</span>;
0083         
0084         <span class="comment">%Reserve space for 10000 enzyme complexs</span>
0085         metaCycEnzymes.cplxs=cell(10000,1);
0086         metaCycEnzymes.cplxComp=cell(10000,1);
0087         metaCycEnzymes.enzymes=cell(50000,1);
0088         
0089         <span class="comment">%Get the information of protein complexes and their components</span>
0090         nCplx=0;
0091         enzymeCounter=0;
0092         
0093         fid = fopen(fullfile(metacycPath,metaCycProteinFile), <span class="string">'r'</span>);
0094         <span class="comment">%Loop through the file</span>
0095         <span class="keyword">while</span> 1
0096             tline = fgetl(fid);
0097             
0098             <span class="comment">%Abort at end of file</span>
0099             <span class="keyword">if</span> ~ischar(tline)
0100                 <span class="keyword">break</span>;
0101             <span class="keyword">end</span>
0102             
0103             <span class="comment">%Add Enzyme id</span>
0104             <span class="keyword">if</span> numel(tline)&gt;12 &amp;&amp; strcmp(tline(1:12),<span class="string">'UNIQUE-ID - '</span>)
0105                 enzymeCounter=enzymeCounter+1;
0106                 addMe=false;
0107                 enzymeID=tline(13:end);
0108                 metaCycEnzymes.enzymes{enzymeCounter}=enzymeID;
0109             <span class="keyword">end</span>
0110             
0111             <span class="comment">%Check if enzyme complexes</span>
0112             <span class="keyword">if</span> strcmp(tline(1:end),<span class="string">'TYPES - Protein-Complexes'</span>)
0113                 nCplx=nCplx+1;
0114                 nComp=0;
0115                 
0116                 <span class="comment">%Reserve 100 subunits for each enzyme complex</span>
0117                 Comp.subunit=cell(100,1);
0118                 metaCycEnzymes.cplxs{nCplx}=enzymeID;
0119                 
0120                 addMe=true;
0121             <span class="keyword">end</span>
0122             
0123             <span class="keyword">if</span> numel(tline)&gt;13 &amp;&amp; strcmp(tline(1:13),<span class="string">'COMPONENTS - '</span>)
0124                 <span class="keyword">if</span> addMe
0125                     nComp=nComp+1;
0126                     Comp.subunit{nComp}=tline(14:end);
0127                 <span class="keyword">end</span>
0128             <span class="keyword">end</span>
0129             
0130             <span class="keyword">if</span> strcmp(tline(1:end),<span class="string">'//'</span>)
0131                 <span class="keyword">if</span> addMe
0132                     Comp.subunit=Comp.subunit(1:nComp);
0133                     metaCycEnzymes.cplxComp{nCplx}=Comp;
0134                     addMe=false;
0135                 <span class="keyword">end</span>
0136             <span class="keyword">end</span>
0137         <span class="keyword">end</span>
0138         <span class="comment">%Close the file</span>
0139         fclose(fid);
0140         
0141         <span class="comment">%If too much space was allocated, shrink the model</span>
0142         metaCycEnzymes.cplxs=metaCycEnzymes.cplxs(1:nCplx);
0143         metaCycEnzymes.cplxComp=metaCycEnzymes.cplxComp(1:nCplx);
0144         metaCycEnzymes.enzymes=metaCycEnzymes.enzymes(1:enzymeCounter);
0145         
0146         <span class="comment">% Iteratively go through the components of each complex</span>
0147         <span class="keyword">for</span> i=1:numel(metaCycEnzymes.cplxComp)
0148             
0149             <span class="comment">%replace all complex-type components with their subunits</span>
0150             checkCplx=true;
0151             <span class="keyword">while</span> checkCplx
0152                 x=0;
0153                 mat=[]; <span class="comment">%Matrix for component of protein-complexs</span>
0154                 <span class="keyword">for</span> j=1:numel(metaCycEnzymes.cplxComp{i}.subunit)
0155                     [a, b]=ismember(metaCycEnzymes.cplxComp{i}.subunit{j},metaCycEnzymes.cplxs);
0156                     <span class="keyword">if</span> a
0157                         x=x+1;   <span class="comment">%record this value j, and the cplx id b</span>
0158                         mat(x,:)=[j b];
0159                     <span class="keyword">end</span>
0160                 <span class="keyword">end</span>
0161                 
0162                 <span class="keyword">if</span> isempty(mat)
0163                     checkCplx=false; <span class="comment">% No complexs found among components</span>
0164                 <span class="keyword">else</span>
0165                     <span class="comment">%go through matrix JB</span>
0166                     <span class="keyword">for</span> k=1:x
0167                         <span class="comment">%disp(metaCycEnzymes.cplxComp{i}.subunit{mat(k,1)});</span>
0168                         metaCycEnzymes.cplxComp{i}.subunit(mat(k,1))=[];
0169                         metaCycEnzymes.cplxComp{i}.subunit=[metaCycEnzymes.cplxComp{i}.subunit; metaCycEnzymes.cplxComp{mat(k,2)}.subunit];
0170                     <span class="keyword">end</span>
0171                 <span class="keyword">end</span>
0172                 
0173             <span class="keyword">end</span>
0174             
0175             <span class="comment">% make sure the subunits are all included in the enzyme list</span>
0176             <span class="comment">% since in one case subunit was not found in enzyme dump file</span>
0177             [a, b] = ismember(metaCycEnzymes.cplxComp{i}.subunit,metaCycEnzymes.enzymes);
0178             <span class="keyword">if</span> ~all(a)
0179                 metaCycEnzymes.cplxComp{i}.subunit = metaCycEnzymes.enzymes(b(find(a)));
0180             <span class="keyword">end</span>
0181         <span class="keyword">end</span>
0182         
0183         <span class="comment">%Preallocate space for 500000 enzymatic reactions</span>
0184         metaCycEnzymes.enzrxns=cell(50000,1);
0185         metaCycEnzymes.rxns=cell(50000,1);
0186         metaCycEnzymes.rxnNames=cell(50000,1);
0187         metaCycEnzymes.commoname=cell(50000,1);
0188         metaCycEnzymes.rxnEnzymeMat=sparse(50000,enzymeCounter); <span class="comment">% row: rxn, column: enzymes</span>
0189         
0190         <span class="comment">%Load enzyme and reaction association information</span>
0191         fid = fopen(fullfile(metacycPath,metaCycEnzrxnsFile), <span class="string">'r'</span>);
0192         
0193         <span class="comment">%Keeps track of how many enzymes and reactions have been added</span>
0194         enzrxnCounter=0;
0195         nRxn=0;
0196         
0197         <span class="comment">%These contain the mapping between Reactions and Enzymes Loop</span>
0198         <span class="comment">%through the file</span>
0199         <span class="keyword">while</span> 1
0200             tline = fgetl(fid);
0201             
0202             <span class="comment">%Abort at end of file</span>
0203             <span class="keyword">if</span> ~ischar(tline)
0204                 <span class="keyword">break</span>;
0205             <span class="keyword">end</span>
0206 
0207             <span class="comment">% Get the version of MetaCyc database</span>
0208             <span class="keyword">if</span> numel(tline)&gt;11 &amp;&amp; strcmp(tline(1:11),<span class="string">'# Version: '</span>)
0209                 metaCycEnzymes.version=tline(12:end);
0210             <span class="keyword">end</span>
0211 
0212             <span class="comment">%Check if it is a new enzymatic reaction</span>
0213             <span class="keyword">if</span> numel(tline)&gt;12 &amp;&amp; strcmp(tline(1:12),<span class="string">'UNIQUE-ID - '</span>)
0214                 enzrxnCounter=enzrxnCounter+1;
0215                 metaCycEnzymes.enzrxns{enzrxnCounter}=tline(13:end);
0216                 metaCycEnzymes.commoname{enzrxnCounter}=<span class="string">''</span>;
0217             <span class="keyword">end</span>
0218             
0219             <span class="comment">%Add common name of enzymatic reactions</span>
0220             <span class="keyword">if</span> numel(tline)&gt;14 &amp;&amp; strcmp(tline(1:14),<span class="string">'COMMON-NAME - '</span>)
0221                 metaCycEnzymes.commoname{enzrxnCounter}=tline(15:end);
0222                 
0223                 <span class="comment">%Remove HTML symobls</span>
0224                 metaCycEnzymes.commoname{enzrxnCounter}=regexprep(metaCycEnzymes.commoname{enzrxnCounter},<span class="string">'&lt;(\w+)&gt;'</span>,<span class="string">''</span>);
0225                 metaCycEnzymes.commoname{enzrxnCounter}=regexprep(metaCycEnzymes.commoname{enzrxnCounter},<span class="string">'&lt;/(\w+)&gt;'</span>,<span class="string">''</span>);
0226                 metaCycEnzymes.commoname{enzrxnCounter}=regexprep(metaCycEnzymes.commoname{enzrxnCounter},<span class="string">'[&amp;;]'</span>,<span class="string">''</span>);
0227             <span class="keyword">end</span>
0228             
0229             <span class="comment">% I add one cell array rxns for checking existing ones by</span>
0230             <span class="comment">% ismember because I cannot manage field rxns in this function</span>
0231             
0232             <span class="comment">%Add enzyme name</span>
0233             <span class="keyword">if</span> numel(tline)&gt;9 &amp;&amp; strcmp(tline(1:9),<span class="string">'ENZYME - '</span>)
0234                 
0235                 <span class="comment">%Save the index in enzymes field to nEnzyme</span>
0236                 [x, nEnzyme]=ismember(tline(10:end),metaCycEnzymes.enzymes);
0237                 <span class="keyword">if</span> ~x
0238                     <span class="comment">%disp(tline(10:end));</span>
0239                 <span class="keyword">end</span>
0240             <span class="keyword">end</span>
0241             
0242             <span class="comment">%Add reaction id, and rxnNames by concatenating unique common</span>
0243             <span class="comment">%names</span>
0244             <span class="keyword">if</span> numel(tline)&gt;11 &amp;&amp; strcmp(tline(1:11),<span class="string">'REACTION - '</span>)
0245                 nRxn=nRxn+1;
0246                 rxns{nRxn}=<span class="string">''</span>;
0247                 rxnID=tline(12:end);
0248                 [c, d]=ismember(rxnID,rxns);
0249                 <span class="keyword">if</span> c
0250                     nRxn=nRxn-1;
0251                     
0252                     <span class="comment">%Check if this common name has been included by</span>
0253                     <span class="comment">%rxnNames</span>
0254                     k=strfind(metaCycEnzymes.rxnNames{d},metaCycEnzymes.commoname{enzrxnCounter});
0255                     <span class="keyword">if</span> isempty(k)
0256                         metaCycEnzymes.rxnNames{d}=strcat(metaCycEnzymes.rxnNames{d},<span class="string">';'</span>,metaCycEnzymes.commoname{enzrxnCounter});
0257                     <span class="keyword">end</span>
0258                     metaCycEnzymes.rxnEnzymeMat(d,nEnzyme)=1;
0259                 <span class="keyword">else</span>
0260                     metaCycEnzymes.rxns{nRxn}=rxnID;
0261                     metaCycEnzymes.rxnNames{nRxn}=metaCycEnzymes.commoname{enzrxnCounter};
0262                     rxns{nRxn}=rxnID;
0263                     metaCycEnzymes.rxnEnzymeMat(nRxn,nEnzyme)=1;
0264                 <span class="keyword">end</span>
0265             <span class="keyword">end</span>
0266             
0267         <span class="keyword">end</span>
0268         
0269         <span class="comment">%Close the file</span>
0270         fclose(fid);
0271         
0272         <span class="comment">%Shrink the sizes</span>
0273         metaCycEnzymes.enzrxns=metaCycEnzymes.enzrxns(1:enzrxnCounter);
0274         metaCycEnzymes.commoname=metaCycEnzymes.commoname(1:enzrxnCounter);
0275         metaCycEnzymes.rxns=metaCycEnzymes.rxns(1:nRxn);
0276         metaCycEnzymes.rxnNames=metaCycEnzymes.rxnNames(1:nRxn);
0277         metaCycEnzymes.rxnEnzymeMat=metaCycEnzymes.rxnEnzymeMat(1:nRxn,:);
0278         
0279         <span class="comment">%Save the model structure</span>
0280         save(enzymesFile,<span class="string">'metaCycEnzymes'</span>);
0281         fprintf([<span class="string">'New metaCycEnzymes.mat has been successfully updated!\n\n'</span>]);
0282     <span class="keyword">end</span>
0283     
0284 <span class="keyword">end</span>
0285 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 03-Jun-2020 13:07:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>