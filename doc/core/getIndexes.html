<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of getIndexes</title>
  <meta name="keywords" content="getIndexes">
  <meta name="description" content="getIndexes">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">core</a> &gt; getIndexes.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for core&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>getIndexes
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>getIndexes</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function indexes=getIndexes(model, objects, type, returnLogical) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> getIndexes
   Retrieves the indexes for a list of reactions or metabolites

   Input:
   model           a model structure
   objects         either a cell array of IDs, a logical vector with the
                   same number of elements as metabolites in the model,
                   of a vector of indexes
   type            'rxns', 'mets', or 'genes' depending on what to retrieve
                   'metnames' queries metabolite names, while 'metscomps'
                   allows to provide specific metabolites and their
                   compartments in the format metaboliteName[comp]
   returnLogical   Sets whether to return a logical array or an array with
                   the indexes (opt, default false)

   Output:
   indexes         can be a logical array or a double array depending on
                   the value of returnLogical

     Usage: indexes=getIndexes(model, objects, type, returnLogical)

   Eduard Kerkhoven, 2018-03-03</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>	dispEM</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="addExchangeRxns.html" class="code" title="function [model, addedRxns]=addExchangeRxns(model,reactionType,mets)">addExchangeRxns</a>	addExchangeRxns</li><li><a href="changeGeneAssoc.html" class="code" title="function model = changeGeneAssoc(model,rxnID,geneAssoc,replace)">changeGeneAssoc</a>	changeGeneAssoc</li><li><a href="changeGrRules.html" class="code" title="function model = changeGrRules(model,rxns,grRules,replace)">changeGrRules</a>	changeGrRules</li><li><a href="constructEquations.html" class="code" title="function equationStrings=constructEquations(model,rxns,useComps,sortRevRxns,sortMetNames,useMetID,useFormula)">constructEquations</a>	constructEquations</li><li><a href="consumeSomething.html" class="code" title="function [solution, metabolite]=consumeSomething(model,ignoreMets,isNames,minNrFluxes,params,ignoreIntBounds)">consumeSomething</a>	consumeSomething</li><li><a href="convertToIrrev.html" class="code" title="function irrevModel=convertToIrrev(model,rxns)">convertToIrrev</a>	convertToIrrev</li><li><a href="copyToComps.html" class="code" title="function model=copyToComps(model,toComps,rxns,deleteOriginal,compNames,compOutside)">copyToComps</a>	copyToComps</li><li><a href="getAllRxnsFromGenes.html" class="code" title="function allRxns=getAllRxnsFromGenes(model,rxns)">getAllRxnsFromGenes</a>	getAllRxnsFromGenes</li><li><a href="getAllowedBounds.html" class="code" title="function [minFluxes, maxFluxes, exitFlags]=getAllowedBounds(model,rxns)">getAllowedBounds</a>	getAllowedBounds</li><li><a href="getElementalBalance.html" class="code" title="function balanceStructure=getElementalBalance(model,rxns,printUnbalanced,printUnparsable)">getElementalBalance</a>	getElementalBalance</li><li><a href="haveFlux.html" class="code" title="function I=haveFlux(model,cutOff,rxns)">haveFlux</a>	haveFlux</li><li><a href="makeSomething.html" class="code" title="function [solution, metabolite]=makeSomething(model,ignoreMets,isNames,minNrFluxes,allowExcretion,params,ignoreIntBounds)">makeSomething</a>	makeSomething</li><li><a href="printModel.html" class="code" title="function printModel(model,rxnList,outputString,outputFile,metaboliteList)">printModel</a>	printModel</li><li><a href="removeGenes.html" class="code" title="function reducedModel = removeGenes(model,genesToRemove,removeUnusedMets,removeBlockedRxns,standardizeRules)">removeGenes</a>	removeGenes</li><li><a href="removeMets.html" class="code" title="function reducedModel=removeMets(model,metsToRemove,isNames,removeUnusedRxns,removeUnusedGenes,removeUnusedComps)">removeMets</a>	removeMets</li><li><a href="removeReactions.html" class="code" title="function reducedModel=removeReactions(model,rxnsToRemove,removeUnusedMets,removeUnusedGenes,removeUnusedComps)">removeReactions</a>	removeReactions</li><li><a href="simplifyModel.html" class="code" title="function [reducedModel, deletedReactions, deletedMetabolites]=simplifyModel(model,deleteUnconstrained, deleteDuplicates, deleteZeroInterval, deleteInaccessible, deleteMinMax, groupLinear, constrainReversible, reservedRxns, suppressWarnings)">simplifyModel</a>	simplifyModel</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function indexes=getIndexes(model, objects, type, returnLogical)</a>
0002 <span class="comment">% getIndexes</span>
0003 <span class="comment">%   Retrieves the indexes for a list of reactions or metabolites</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   Input:</span>
0006 <span class="comment">%   model           a model structure</span>
0007 <span class="comment">%   objects         either a cell array of IDs, a logical vector with the</span>
0008 <span class="comment">%                   same number of elements as metabolites in the model,</span>
0009 <span class="comment">%                   of a vector of indexes</span>
0010 <span class="comment">%   type            'rxns', 'mets', or 'genes' depending on what to retrieve</span>
0011 <span class="comment">%                   'metnames' queries metabolite names, while 'metscomps'</span>
0012 <span class="comment">%                   allows to provide specific metabolites and their</span>
0013 <span class="comment">%                   compartments in the format metaboliteName[comp]</span>
0014 <span class="comment">%   returnLogical   Sets whether to return a logical array or an array with</span>
0015 <span class="comment">%                   the indexes (opt, default false)</span>
0016 <span class="comment">%</span>
0017 <span class="comment">%   Output:</span>
0018 <span class="comment">%   indexes         can be a logical array or a double array depending on</span>
0019 <span class="comment">%                   the value of returnLogical</span>
0020 <span class="comment">%</span>
0021 <span class="comment">%     Usage: indexes=getIndexes(model, objects, type, returnLogical)</span>
0022 <span class="comment">%</span>
0023 <span class="comment">%   Eduard Kerkhoven, 2018-03-03</span>
0024 <span class="comment">%</span>
0025 
0026 <span class="keyword">if</span> nargin&lt;4
0027     returnLogical=false;
0028 <span class="keyword">end</span>
0029 
0030 <span class="comment">%If the supplied object is a character array, then convert it to a cell</span>
0031 <span class="comment">%array</span>
0032 <span class="keyword">if</span> ischar(objects)
0033     objects={objects};
0034 <span class="keyword">end</span>
0035 
0036 indexes=[];
0037 
0038 <span class="keyword">if</span> strcmpi(type,<span class="string">'rxns'</span>)
0039     searchIn=model.rxns;
0040 <span class="keyword">elseif</span> strcmpi(type,<span class="string">'mets'</span>)
0041     searchIn=model.mets;
0042 <span class="keyword">elseif</span> strcmpi(type,<span class="string">'genes'</span>)
0043     searchIn=model.genes;
0044 <span class="keyword">elseif</span> strcmpi(type,<span class="string">'metnames'</span>)
0045     searchIn=model.metNames;
0046 <span class="keyword">elseif</span> strcmpi(type,<span class="string">'metscomps'</span>)
0047     <span class="comment">% If provided as metaboliteName[comp], then index search is quite</span>
0048     <span class="comment">% different from general approach, and therefore coded separately.</span>
0049     <span class="keyword">if</span> isstr(objects)
0050         objects={objects};
0051     <span class="keyword">end</span>
0052     mets=regexprep(objects,<span class="string">'(^.+)\[(.+)\]$'</span>,<span class="string">'$1'</span>);
0053     comps=regexprep(objects,<span class="string">'(^.+)\[(.+)\]$'</span>,<span class="string">'$2'</span>);
0054     <span class="keyword">for</span> i=1:numel(objects)
0055         index=find(strcmp(mets(i),model.metNames));
0056         index=index(strcmp(comps(i),model.comps(model.metComps(index))));
0057         <span class="keyword">if</span> ~isempty(index)
0058             indexes(i)=index;
0059         <span class="keyword">else</span>
0060             EM=[<span class="string">'Could not find object '</span> objects{i} <span class="string">' in the model'</span>];
0061             <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(EM);
0062         <span class="keyword">end</span>
0063     <span class="keyword">end</span>
0064     indexes=indexes(:);
0065     <span class="keyword">if</span> returnLogical==true
0066         tempIndexes=false(numel(model.mets),1);
0067         tempIndexes(indexes)=true;
0068         indexes=tempIndexes;
0069     <span class="keyword">end</span>
0070     <span class="keyword">return</span>; <span class="comment">% If metscomps is queried, remaining codes doesn't need executing</span>
0071 <span class="keyword">else</span>
0072     EM=<span class="string">'Incorrect value of the &quot;type&quot; parameter. Allowed values are &quot;rxns&quot;, &quot;mets&quot; or &quot;genes&quot;'</span>;
0073     <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(EM);
0074 <span class="keyword">end</span>
0075 
0076 <span class="keyword">if</span> iscell(objects)
0077     <span class="keyword">for</span> i=1:numel(objects)
0078         index=find(strcmp(objects(i),searchIn));
0079         <span class="keyword">if</span> strcmpi(type,<span class="string">'metnames'</span>)
0080             indexes{i}=index;
0081         <span class="keyword">elseif</span> ~isempty(index)
0082             indexes(i)=index;
0083         <span class="keyword">else</span>
0084             EM=[<span class="string">'Could not find object '</span> objects{i} <span class="string">' in the model'</span>];
0085             <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(EM);
0086         <span class="keyword">end</span>
0087     <span class="keyword">end</span>
0088 <span class="keyword">else</span>
0089     <span class="comment">%Now it's either a logical (or 0/1) array or an array with indexes. We</span>
0090     <span class="comment">%want it to be an array with indexes.</span>
0091     <span class="keyword">if</span> all(objects)
0092         <span class="comment">%This gets weird if it's all 1</span>
0093         indexes=objects;
0094     <span class="keyword">else</span>
0095         indexes=find(objects);
0096     <span class="keyword">end</span>
0097 <span class="keyword">end</span>
0098 
0099 <span class="keyword">if</span> returnLogical==true
0100     tempIndexes=false(numel(searchIn),1);
0101     tempIndexes(indexes)=true;
0102     indexes=tempIndexes;
0103 <span class="keyword">end</span>
0104 
0105 indexes=indexes(:);
0106 <span class="keyword">if</span> iscell(indexes) &amp;&amp; length(indexes)==1
0107     indexes=indexes{1};
0108 <span class="keyword">end</span>
0109 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 03-Jun-2020 13:07:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>